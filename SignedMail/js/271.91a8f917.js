"use strict";(self["webpackChunksignedmail"]=self["webpackChunksignedmail"]||[]).push([[271],{9271:(e,t,a)=>{a.r(t),a.d(t,{default:()=>B});var l=a(3673),i=a(2323);const s={key:0},n=(0,l.Uk)(" There are messages that are currently encrypted. "),u=(0,l.Uk)("Try decrypting again"),r={key:1},o={class:"text-h6"},c={class:"text-subtitle1"},d={class:"row q-pa-sm q-gutter-md"},y=(0,l.Uk)(" No results "),p={class:"row q-gutter-md"};function v(e,t,a,v,m,h){const g=(0,l.up)("q-banner"),b=(0,l.up)("q-btn"),w=(0,l.up)("q-item-section"),K=(0,l.up)("q-item"),f=(0,l.up)("q-list"),D=(0,l.up)("q-select"),k=(0,l.up)("q-page"),C=(0,l.Q2)("ripple");return(0,l.wg)(),(0,l.j4)(k,null,{default:(0,l.w5)((()=>[(0,l.Wm)(g,{class:"bg-primary text-white"},{default:(0,l.w5)((()=>{var t;return[(0,l.Uk)((0,i.zw)(null===(t=e.privateKey)||void 0===t?void 0:t.userID)+" Chats ",1)]})),_:1}),e.hasEncryptedMessages?((0,l.wg)(),(0,l.iD)("span",s,[n,(0,l.Wm)(b,{color:"primary",onClick:e.retryDecryption},{default:(0,l.w5)((()=>[u])),_:1},8,["onClick"])])):0===e.uniqueChats.length?((0,l.wg)(),(0,l.iD)("span",r," No chats found. Start one below from the list. ")):((0,l.wg)(),(0,l.j4)(f,{key:2,dense:"",bordered:"",padding:"",class:"rounded-borders"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.uniqueChats,(t=>(0,l.wy)(((0,l.wg)(),(0,l.j4)(K,(0,l.dG)({key:t.detail.theirPublicKeyID},t,{clickable:"",onClick:a=>e.rowClick(t.detail.theirPublicKeyID)}),{default:(0,l.w5)((()=>[(0,l.Wm)(w,null,{default:(0,l.w5)((()=>[(0,l._)("span",o,(0,i.zw)(t.detail.userID),1),(0,l._)("span",c,(0,i.zw)(t.detail.createdDate),1)])),_:2},1024)])),_:2},1040,["onClick"])),[[C]]))),128))])),_:1})),(0,l._)("div",d,[(0,l.Wm)(D,{filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",options:e.publicKeyOptions,hint:"Public Keys","option-value":"keyID","option-label":"userID",onFilter:e.publicKeyFilterFn,modelValue:e.publicKeySelected,"onUpdate:modelValue":t[0]||(t[0]=t=>e.publicKeySelected=t)},{"no-option":(0,l.w5)((()=>[(0,l.Wm)(K,null,{default:(0,l.w5)((()=>[(0,l.Wm)(w,{class:"text-grey"},{default:(0,l.w5)((()=>[y])),_:1})])),_:1})])),_:1},8,["options","onFilter","modelValue"])]),(0,l._)("div",p,[(0,l.Wm)(b,{color:"primary",label:"Start chat",onClick:e.startChat,disable:!e.publicKeySelected},null,8,["onClick","disable"])])])),_:1})}var m=a(8430),h=a(8825),g=a(1959),b=a(9582),w=a(27),K=a(2079),f=a(912);const D=(0,l.aZ)({name:"Chats",setup(){const e=(0,h.Z)(),t=(0,b.tv)(),a=(0,b.yj)(),i=(0,g.iH)(""),s=(0,g.iH)(),n=(0,g.iH)(K.gb.getPublicKeys),u=(0,g.Fl)((()=>w.Vu.getChatsByPrivateKeyID(i.value))),r=(0,g.Fl)((()=>w.Vu.getUniqueChatsByPrivateKeyID(i.value))),o=(0,g.Fl)((()=>w.Vu.getMessagesByPrivateKeyID(i.value))),c=(0,g.Fl)((()=>K.gb.getPrivateKeyByKeyID(i.value))),d=(0,g.Fl)((()=>K.gb.getPublicKeys)),y=(e,t)=>{t(""!==e?()=>{const t=e.toLowerCase();n.value=d.value.filter((e=>e.userID.toLowerCase().indexOf(t)>-1))}:()=>{n.value=d.value})},p=()=>(0,m.mG)(this,void 0,void 0,(function*(){if(o.value.length>u.value.length)try{yield(0,f.Z0)(i.value)}catch(t){const a=t;e.notify({type:"negative",message:`Could not convert messages into chats. Reason: ${a.message}`})}}));return(0,l.bv)((()=>(0,m.mG)(this,void 0,void 0,(function*(){a.params.myPrivateKeyID&&(i.value=a.params.myPrivateKeyID,yield p())})))),(0,l.YP)((()=>a.params.myPrivateKeyID),(()=>(0,m.mG)(this,void 0,void 0,(function*(){i.value=a.params.myPrivateKeyID,yield p()})))),{hasEncryptedMessages:(0,g.Fl)((()=>w.Vu.hasEncryptedMessages(i.value))),uniqueChats:r,rowClick:e=>t.push({name:"chat",params:{theirPublicKeyID:e}}),startChat:()=>s.value?t.push({name:"chat",params:{theirPublicKeyID:s.value.keyID}}):null,publicKeyOptions:n,publicKeySelected:s,publicKeyFilterFn:y,privateKey:c,retryDecryption:()=>(0,m.mG)(this,void 0,void 0,(function*(){return yield p()}))}}});var k=a(4260),C=a(4379),I=a(5607),P=a(8240),q=a(7011),_=a(3414),F=a(2035),Z=a(7208),Q=a(6489),S=a(7518),V=a.n(S);const W=(0,k.Z)(D,[["render",v]]),B=W;V()(D,"components",{QPage:C.Z,QBanner:I.Z,QBtn:P.Z,QList:q.Z,QItem:_.Z,QItemSection:F.Z,QSelect:Z.Z}),V()(D,"directives",{Ripple:Q.Z})}}]);