"use strict";(self["webpackChunksignedmail"]=self["webpackChunksignedmail"]||[]).push([[830],{5830:(e,l,t)=>{t.r(l),t.d(l,{default:()=>j});var a=t(3673),i=t(2323);const u={class:"fit row justify-between items-center"},s=(0,a._)("div",null,null,-1),n=(0,a.Uk)(" Once you start a conversation on the device, it will be listed here "),o={key:0},r=(0,a.Uk)(" There are messages that are currently encrypted. "),d=(0,a.Uk)("Try decrypting again"),y={key:1},c={class:"row q-pa-sm q-gutter-md"},p=(0,a.Uk)(" No results "),v={class:"row q-gutter-md"},m={key:0,class:"q-pa-md row"};function h(e,l,t,h,K,g){const w=(0,a.up)("q-tooltip"),b=(0,a.up)("q-btn"),f=(0,a.up)("q-banner"),k=(0,a.up)("q-item-section"),D=(0,a.up)("q-item"),C=(0,a.up)("q-list"),P=(0,a.up)("q-select"),I=(0,a.up)("q-input"),_=(0,a.up)("ShowKeys"),q=(0,a.up)("q-card-section"),W=(0,a.up)("q-card"),Z=(0,a.up)("q-dialog"),V=(0,a.up)("q-page"),F=(0,a.Q2)("ripple");return(0,a.wg)(),(0,a.j4)(V,null,{default:(0,a.w5)((()=>[(0,a.Wm)(f,{class:"bg-primary text-white"},{default:(0,a.w5)((()=>{var l;return[(0,a._)("div",u,[s,(0,a._)("div",null,(0,i.zw)(null===(l=e.privateKey)||void 0===l?void 0:l.userID)+" Chats ",1),(0,a._)("div",null,[(0,a.Wm)(b,{round:"",icon:"help"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"text-subtitle1",style:{"max-width":"70vw"}},{default:(0,a.w5)((()=>[n])),_:1})])),_:1})])])]})),_:1}),e.hasEncryptedMessages?((0,a.wg)(),(0,a.iD)("span",o,[r,(0,a.Wm)(b,{color:"primary",onClick:e.retryDecryption},{default:(0,a.w5)((()=>[d])),_:1},8,["onClick"])])):0===e.uniqueChats.length?((0,a.wg)(),(0,a.iD)("span",y," No chats found. Start one below from the list. ")):((0,a.wg)(),(0,a.j4)(C,{key:2,dense:"",bordered:"",padding:"",class:"rounded-borders"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.uniqueChats,(l=>(0,a.wy)(((0,a.wg)(),(0,a.j4)(D,(0,a.dG)({key:l.detail.theirPublicKeyID},l,{clickable:"",onClick:t=>e.rowClick(l.detail.theirPublicKeyID)}),{default:(0,a.w5)((()=>[(0,a.Wm)(k,null,{default:(0,a.w5)((()=>[(0,a._)("span",null,(0,i.zw)(l.detail.userID),1),(0,a._)("span",null,(0,i.zw)(l.detail.createdDate),1)])),_:2},1024)])),_:2},1040,["onClick"])),[[F]]))),128))])),_:1})),(0,a._)("div",c,[(0,a.Wm)(P,{filled:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"0",options:e.publicKeyOptions,hint:"Public Keys","option-value":"keyID","option-label":"userID",onFilter:e.publicKeyFilterFn,modelValue:e.publicKeySelected,"onUpdate:modelValue":l[0]||(l[0]=l=>e.publicKeySelected=l)},{"no-option":(0,a.w5)((()=>[(0,a.Wm)(D,null,{default:(0,a.w5)((()=>[(0,a.Wm)(k,{class:"text-grey"},{default:(0,a.w5)((()=>[p])),_:1})])),_:1})])),_:1},8,["options","onFilter","modelValue"])]),(0,a._)("div",v,[(0,a.Wm)(b,{color:"primary",label:"Start chat",onClick:e.startChat,disable:!e.publicKeySelected},null,8,["onClick","disable"]),(0,a.Wm)(b,{color:"secondary",label:"New Public Key",onClick:l[1]||(l[1]=l=>e.addNewKey=!0)})]),(0,a.Wm)(Z,{modelValue:e.addNewKey,"onUpdate:modelValue":l[3]||(l[3]=l=>e.addNewKey=l)},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{style:{width:"700px","max-width":"80vw"}},{default:(0,a.w5)((()=>[(0,a.Wm)(q,null,{default:(0,a.w5)((()=>[(0,a.Wm)(I,{modelValue:e.publicKeyValue,"onUpdate:modelValue":l[2]||(l[2]=l=>e.publicKeyValue=l),filled:"",type:"textarea",label:"Public or Private Key",error:!!e.handleAddKeyError.length,"error-message":e.handleAddKeyError},null,8,["modelValue","error","error-message"]),(0,a.Wm)(b,{color:"primary",label:"Add Key",onClick:e.handleAddKey},null,8,["onClick"]),e.showKeys?((0,a.wg)(),(0,a.iD)("div",m,[(0,a.Wm)(_,{keys:e.showKeys},null,8,["keys"])])):(0,a.kq)("",!0)])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}var K=t(8430),g=t(8825),w=t(1959),b=t(9582),f=t(27),k=t(2079),D=t(912),C=t(745);const P=(0,a.aZ)({name:"Chats",components:{ShowKeys:(0,a.RC)((()=>Promise.all([t.e(736),t.e(64),t.e(132)]).then(t.bind(t,3132))))},setup(){const e=(0,g.Z)(),l=(0,b.tv)(),t=(0,b.yj)(),i=(0,w.iH)(""),u=(0,w.iH)(""),s=(0,w.iH)(!1),n=(0,w.iH)(""),o=(0,w.iH)(),r=(0,w.iH)([]),d=(0,w.iH)([]),y=(0,w.iH)(void 0),c=(0,w.Fl)((()=>f.Vu.getChatsByPrivateKeyID(i.value))),p=(0,w.Fl)((()=>f.Vu.getUniqueChatsByPrivateKeyID(i.value))),v=(0,w.Fl)((()=>f.Vu.getMessagesByPrivateKeyID(i.value))),m=(0,w.Fl)((()=>k.gb.getPrivateKeyByKeyID(i.value))),h=(e,l)=>{l(""!==e?()=>{const l=e.toLowerCase();r.value=d.value.filter((e=>e.userID.toLowerCase().indexOf(l)>-1))}:()=>{r.value=d.value})},P=()=>(0,K.mG)(this,void 0,void 0,(function*(){if(i.value=t.params.myPrivateKeyID,r.value=yield k.gb.getPublicKeysWithoutPrivateKey(i.value),v.value.length>c.value.length)try{yield(0,D.Z0)(i.value)}catch(l){const t=l;e.notify({type:"negative",message:`Could not convert messages into chats. Reason: ${t.message}`})}})),I=()=>(0,K.mG)(this,void 0,void 0,(function*(){n.value="";const l=(0,w.Fl)((()=>k.gb.getPublicKeys)),t=(0,w.Fl)((()=>k.gb.getPrivateKeys)),a=e=>l.value.find((l=>l.keyID===e.getKeyID().toHex())),i=e=>t.value.find((l=>l.keyID===e.getKeyID().toHex()));let s;try{s=yield(0,C.yG)({armoredKey:u.value})}catch(o){const{message:e}=o;n.value=e}s&&(s.isPrivate()&&i(s)||a(s)?e.notify({type:"negative",message:"This key already exists locally"}):yield k.gb.importPublicKey({key:s}),y.value={publicKey:s})}));return(0,a.bv)((()=>(0,K.mG)(this,void 0,void 0,(function*(){t.params.myPrivateKeyID&&(yield P())})))),(0,a.YP)((()=>t.params.myPrivateKeyID),(()=>(0,K.mG)(this,void 0,void 0,(function*(){yield P()})))),(0,a.YP)(i,(()=>(0,K.mG)(this,void 0,void 0,(function*(){i.value&&(d.value=yield k.gb.getPublicKeysWithoutPrivateKey(i.value))})))),{addNewKey:s,publicKeyValue:u,showKeys:y,handleAddKey:I,handleAddKeyError:n,hasEncryptedMessages:(0,w.Fl)((()=>f.Vu.hasEncryptedMessages(i.value))),uniqueChats:p,rowClick:e=>l.push({name:"chat",params:{theirPublicKeyID:e}}),startChat:()=>o.value?l.push({name:"chat",params:{theirPublicKeyID:o.value.keyID}}):null,publicKeyOptions:r,publicKeySelected:o,publicKeyFilterFn:h,privateKey:m,retryDecryption:()=>(0,K.mG)(this,void 0,void 0,(function*(){return yield P()}))}}});var I=t(4260),_=t(4379),q=t(5607),W=t(8240),Z=t(8870),V=t(7011),F=t(3414),Q=t(2035),x=t(7208),H=t(6778),S=t(151),G=t(5589),U=t(4842),N=t(6489),A=t(7518),B=t.n(A);const E=(0,I.Z)(P,[["render",h]]),j=E;B()(P,"components",{QPage:_.Z,QBanner:q.Z,QBtn:W.Z,QTooltip:Z.Z,QList:V.Z,QItem:F.Z,QItemSection:Q.Z,QSelect:x.Z,QDialog:H.Z,QCard:S.Z,QCardSection:G.Z,QInput:U.Z}),B()(P,"directives",{Ripple:N.Z})}}]);